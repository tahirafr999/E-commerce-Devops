{% extends "base.html" %}

{% block title %}Order #{{ order.id }} - E-Commerce Store{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Order Header -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Order #{{ order.id }}</h1>
                <p class="text-gray-600">Placed on {{ order.created_at|date:"F d, Y" }} at {{ order.created_at|time:"g:i A" }}</p>
            </div>
            <div class="text-right">
                <div class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                    {% if order.status == 'pending' %}bg-yellow-100 text-yellow-800
                    {% elif order.status == 'processing' %}bg-blue-100 text-blue-800
                    {% elif order.status == 'shipped' %}bg-purple-100 text-purple-800
                    {% elif order.status == 'delivered' %}bg-green-100 text-green-800
                    {% else %}bg-red-100 text-red-800{% endif %}">
                    {{ order.get_status_display }}
                </div>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Order Items -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-6">Order Items</h2>

                {% for item in order.items.all %}
                    <div class="flex items-center border-b border-gray-200 py-4 {% if forloop.last %}border-b-0{% endif %}">
                        <div class="w-20 h-20 flex-shrink-0">
                            {% if item.product.image %}
                                <img src="{{ item.product.image }}" alt="{{ item.product.name }}"
                                     class="w-full h-full object-cover rounded">
                            {% else %}
                                <div class="w-full h-full bg-gray-200 rounded flex items-center justify-center">
                                    <span class="text-gray-500 text-xs">No image</span>
                                </div>
                            {% endif %}
                        </div>
                        <div class="flex-grow ml-4">
                            <h3 class="font-semibold">
                                <a href="{{ item.product.get_absolute_url }}" class="hover:text-primary">
                                    {{ item.product.name }}
                                </a>
                            </h3>
                            <p class="text-sm text-gray-600">{{ item.product.category.name }}</p>
                            <p class="text-sm text-gray-600">Price: ${{ item.price }} each</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold">Qty: {{ item.quantity }}</p>
                            <p class="font-bold text-primary">${{ item.get_total_price }}</p>
                        </div>
                    </div>
                {% endfor %}

                <div class="mt-6 pt-4 border-t border-gray-200">
                    <div class="flex justify-between text-lg font-bold">
                        <span>Order Total:</span>
                        <span class="text-primary">${{ order.total_amount }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Details -->
        <div class="lg:col-span-1 space-y-6">
            <!-- Shipping Information -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">Shipping Address</h3>
                <div class="text-gray-700">
                    <p>{{ order.first_name }} {{ order.last_name }}</p>
                    <p>{{ order.address }}</p>
                    <p>{{ order.city }}, {{ order.postal_code }}</p>
                    <p>{{ order.country }}</p>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">Contact Information</h3>
                <div class="text-gray-700">
                    <p>{{ order.email }}</p>
                </div>
            </div>

            <!-- Order Status -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">Order Status</h3>
                <div class="space-y-2">
                    <div class="flex items-center">
                        <div class="w-4 h-4 rounded-full mr-3
                            {% if order.status == 'pending' or order.status == 'processing' or order.status == 'shipped' or order.status == 'delivered' %}
                                bg-green-500
                            {% else %}
                                bg-gray-300
                            {% endif %}">
                        </div>
                        <span class="text-sm">Order Placed</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 rounded-full mr-3
                            {% if order.status == 'processing' or order.status == 'shipped' or order.status == 'delivered' %}
                                bg-green-500
                            {% else %}
                                bg-gray-300
                            {% endif %}">
                        </div>
                        <span class="text-sm">Processing</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 rounded-full mr-3
                            {% if order.status == 'shipped' or order.status == 'delivered' %}
                                bg-green-500
                            {% else %}
                                bg-gray-300
                            {% endif %}">
                        </div>
                        <span class="text-sm">Shipped</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 rounded-full mr-3
                            {% if order.status == 'delivered' %}
                                bg-green-500
                            {% else %}
                                bg-gray-300
                            {% endif %}">
                        </div>
                        <span class="text-sm">Delivered</span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="space-y-3">
                <a href="{% url 'shop:product_list' %}"
                   class="w-full bg-primary text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300 text-center block">
                    Continue Shopping
                </a>
                <a href="{% url 'shop:home' %}"
                   class="w-full bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-300 text-center block">
                    Back to Home
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}